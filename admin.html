<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ModAPK Admin Panel</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Admin Header -->
    <nav class="admin-navbar">
        <div class="admin-nav-container">
            <div class="admin-nav-brand">
                <i class="fas fa-shield-alt"></i>
                <span>ModAPK Admin</span>
            </div>
            <div class="admin-nav-menu">
                <button class="admin-nav-item active" onclick="showAdminView('dashboard')">
                    <i class="fas fa-chart-bar"></i>
                    Dashboard
                </button>
                <button class="admin-nav-item" onclick="showAdminView('apks')">
                    <i class="fas fa-mobile-alt"></i>
                    Manage APKs
                </button>
                <button class="admin-nav-item" onclick="showAdminView('users')">
                    <i class="fas fa-users"></i>
                    Users
                </button>
                <button class="admin-nav-item" onclick="showAdminView('analytics')">
                    <i class="fas fa-analytics"></i>
                    Analytics
                </button>
                <button class="admin-nav-item" onclick="showAdminView('settings')">
                    <i class="fas fa-cog"></i>
                    Settings
                </button>
                <button class="admin-nav-item" onclick="window.open('index.html', '_blank')">
                    <i class="fas fa-external-link-alt"></i>
                    View Site
                </button>
            </div>
            <div class="admin-user-info">
                <span id="admin-username">Admin</span>
                <button onclick="adminLogout()" class="btn-logout">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>
    </nav>

    <div class="admin-container">
        <!-- Dashboard View -->
        <div id="admin-dashboard" class="admin-view active">
            <div class="admin-header">
                <h1>Dashboard Overview</h1>
                <p>Welcome to the ModAPK Admin Panel</p>
            </div>

            <div class="admin-stats">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="total-apks">0</div>
                        <div class="stat-label">Total APKs</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-download"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="total-downloads">0</div>
                        <div class="stat-label">Downloads Today</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="total-users">0</div>
                        <div class="stat-label">Active Users</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="avg-rating">4.8</div>
                        <div class="stat-label">Average Rating</div>
                    </div>
                </div>
            </div>

            <div class="admin-charts">
                <div class="chart-card">
                    <h3>Downloads Over Time</h3>
                    <canvas id="downloadsChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3>Popular Categories</h3>
                    <canvas id="categoriesChart"></canvas>
                </div>
            </div>

            <div class="recent-activity">
                <h3>Recent Activity</h3>
                <div class="activity-list" id="activity-list">
                    <!-- Activity items will be populated here -->
                </div>
            </div>
        </div>

        <!-- APKs Management View -->
        <div id="admin-apks" class="admin-view">
            <div class="admin-header">
                <h1>Manage APKs</h1>
                <button class="btn-primary" onclick="showAddAPKModal()">
                    <i class="fas fa-plus"></i>
                    Add New APK
                </button>
            </div>

            <div class="admin-filters">
                <div class="filter-group">
                    <input type="text" id="apk-search" placeholder="Search APKs..." class="filter-input">
                    <select id="category-filter" class="filter-select">
                        <option value="">All Categories</option>
                        <option value="Social">Social</option>
                        <option value="Music">Music</option>
                        <option value="Entertainment">Entertainment</option>
                        <option value="Games">Games</option>
                        <option value="Tools">Tools</option>
                    </select>
                    <select id="status-filter" class="filter-select">
                        <option value="">All Status</option>
                        <option value="verified">Verified</option>
                        <option value="featured">Featured</option>
                        <option value="trending">Trending</option>
                    </select>
                </div>
                <div class="bulk-actions">
                    <button class="btn-secondary" onclick="bulkVerify()">Bulk Verify</button>
                    <button class="btn-secondary" onclick="bulkDelete()">Bulk Delete</button>
                </div>
            </div>

            <div class="apks-table-container">
                <table class="apks-table">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="select-all"></th>
                            <th>Icon</th>
                            <th>Name</th>
                            <th>Version</th>
                            <th>Category</th>
                            <th>Downloads</th>
                            <th>Rating</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="apks-table-body">
                        <!-- APKs will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Users Management View -->
        <div id="admin-users" class="admin-view">
            <div class="admin-header">
                <h1>User Management</h1>
                <button class="btn-primary" onclick="showAddUserModal()">
                    <i class="fas fa-user-plus"></i>
                    Add User
                </button>
            </div>

            <div class="users-table-container">
                <table class="users-table">
                    <thead>
                        <tr>
                            <th>Avatar</th>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Join Date</th>
                            <th>Last Login</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="users-table-body">
                        <!-- Users will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Analytics View -->
        <div id="admin-analytics" class="admin-view">
            <div class="admin-header">
                <h1>Analytics & Reports</h1>
                <div class="date-range">
                    <input type="date" id="start-date" class="date-input">
                    <input type="date" id="end-date" class="date-input">
                    <button class="btn-primary" onclick="updateAnalytics()">Update</button>
                </div>
            </div>

            <div class="analytics-grid">
                <div class="analytics-card">
                    <h3>Top Downloaded APKs</h3>
                    <div id="top-apks-list"></div>
                </div>
                <div class="analytics-card">
                    <h3>User Growth</h3>
                    <canvas id="userGrowthChart"></canvas>
                </div>
                <div class="analytics-card">
                    <h3>Download Trends</h3>
                    <canvas id="downloadTrendsChart"></canvas>
                </div>
                <div class="analytics-card">
                    <h3>Device Analytics</h3>
                    <div id="device-stats"></div>
                </div>
            </div>
        </div>

        <!-- Settings View -->
        <div id="admin-settings" class="admin-view">
            <div class="admin-header">
                <h1>Platform Settings</h1>
            </div>

            <div class="settings-sections">
                <div class="settings-section">
                    <h3>General Settings</h3>
                    <div class="setting-item">
                        <label>Site Name</label>
                        <input type="text" value="ModAPK Platform" class="setting-input">
                    </div>
                    <div class="setting-item">
                        <label>Site Description</label>
                        <textarea class="setting-textarea">Premium modded apps and games</textarea>
                    </div>
                    <div class="setting-item">
                        <label>Featured APKs Limit</label>
                        <input type="number" value="6" class="setting-input">
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Upload Settings</h3>
                    <div class="setting-item">
                        <label>Max File Size (MB)</label>
                        <input type="number" value="100" class="setting-input">
                    </div>
                    <div class="setting-item">
                        <label>Allowed File Types</label>
                        <input type="text" value=".apk,.xapk,.apkm" class="setting-input">
                    </div>
                    <div class="setting-item">
                        <label>Auto-approve Uploads</label>
                        <input type="checkbox" class="setting-checkbox">
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Security Settings</h3>
                    <div class="setting-item">
                        <label>Enable User Registration</label>
                        <input type="checkbox" checked class="setting-checkbox">
                    </div>
                    <div class="setting-item">
                        <label>Require Email Verification</label>
                        <input type="checkbox" class="setting-checkbox">
                    </div>
                    <div class="setting-item">
                        <label>Enable Download Limits</label>
                        <input type="checkbox" class="setting-checkbox">
                    </div>
                </div>

                <div class="settings-actions">
                    <button class="btn-primary" onclick="saveSettings()">Save Settings</button>
                    <button class="btn-secondary" onclick="resetSettings()">Reset to Default</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add APK Modal -->
    <div id="add-apk-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New APK</h2>
                <button class="modal-close" onclick="closeModal('add-apk-modal')">×</button>
            </div>
            <form id="add-apk-form" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>App Name*</label>
                        <input type="text" name="name" required class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Version*</label>
                        <input type="text" name="version" required class="form-input">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Package Name*</label>
                        <input type="text" name="package_name" required class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Category*</label>
                        <select name="category" required class="form-select">
                            <option value="">Select Category</option>
                            <option value="Social">Social</option>
                            <option value="Music">Music</option>
                            <option value="Entertainment">Entertainment</option>
                            <option value="Games">Games</option>
                            <option value="Tools">Tools</option>
                            <option value="Productivity">Productivity</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea name="description" rows="3" class="form-textarea"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Download URL*</label>
                        <input type="url" name="download_url" required class="form-input">
                    </div>
                    <div class="form-group">
                        <label>File Size</label>
                        <input type="text" name="file_size" placeholder="e.g., 25.3 MB" class="form-input">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Icon URL</label>
                        <input type="url" name="icon_url" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Android Version</label>
                        <input type="text" name="android_version" placeholder="e.g., 5.0+" class="form-input">
                    </div>
                </div>
                <div class="form-group">
                    <label>Screenshot URLs (comma-separated)</label>
                    <input type="text" name="screenshot_urls" class="form-input" placeholder="https://example.com/1.jpg, https://example.com/2.jpg">
                </div>
                <div class="form-group">
                    <label>Features (comma-separated)</label>
                    <input type="text" name="features" class="form-input" placeholder="Ad-Free, Premium Unlocked">
                </div>
                <div class="form-group">
                    <label>Tags (comma-separated)</label>
                    <input type="text" name="tags" class="form-input" placeholder="social, messaging, privacy">
                </div>
                <div class="form-checkboxes">
                    <label class="checkbox-label">
                        <input type="checkbox" name="verified"> Verified
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="featured"> Featured
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="trending"> Trending
                    </label>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('add-apk-modal')">Cancel</button>
                    <button type="submit" class="btn-primary">Add APK</button>
                </div>
            </form>
        </div>
    </div>

    <!-- File Upload Modal -->
    <div id="file-upload-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Upload APK File</h2>
                <button class="modal-close" onclick="closeModal('file-upload-modal')">×</button>
            </div>
            <div class="upload-area" id="upload-area">
                <div class="upload-content">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3>Drag & Drop APK File Here</h3>
                    <p>or click to browse</p>
                    <input type="file" id="file-input" accept=".apk,.xapk,.apkm" hidden>
                </div>
                <div class="upload-progress" id="upload-progress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-text" id="progress-text">Uploading... 0%</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin JavaScript -->
    <script>
    // Admin Platform Implementation
    class AdminPlatform {
        constructor() {
            // Hardcoded Supabase configuration
            this.supabaseUrl = 'https://jpzexvamlwxfyhgeuzpc.supabase.co';
            this.supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpwemV4dmFtbHd4ZnloZ2V1enBjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxNDc0NzYsImV4cCI6MjA3MTcyMzQ3Nn0.wBuPkCmrlyqJhq2KsNiS_1Al3CDlFRudOCEIGHkML7E';
            
            // Initialize Supabase
            try {
                this.supabase = window.supabase?.createClient(this.supabaseUrl, this.supabaseKey);
            } catch (error) {
                console.log('Supabase not available, using local data');
                this.supabase = null;
            }
            
            this.currentView = 'dashboard';
            this.apks = [];
            this.users = [];
            this.analytics = {};
            
            this.init();
        }
        
        async init() {
            this.setupEventListeners();
            await this.loadData();
            this.renderDashboard();
            this.checkAuth();
        }
        
        checkAuth() {
            // Simple admin check - in real app, verify with backend
            const isAdmin = localStorage.getItem('isAdmin') === 'true';
            if (!isAdmin) {
                // Redirect to main site or show login
                window.location.href = 'index.html';
            }
        }
        
        setupEventListeners() {
            // Add APK form
            document.getElementById('add-apk-form').addEventListener('submit', (e) => {
                e.preventDefault();
                this.handleAddAPK(new FormData(e.target));
            });
            
            // Upload area
            const uploadArea = document.getElementById('upload-area');
            const fileInput = document.getElementById('file-input');
            
            uploadArea.addEventListener('click', () => fileInput.click());
            uploadArea.addEventListener('dragover', (e) => e.preventDefault());
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                const files = e.dataTransfer.files;
                if (files.length > 0) this.handleFileUpload(files[0]);
            });
            
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) this.handleFileUpload(e.target.files[0]);
            });
            
            // Search and filters
            document.getElementById('apk-search').addEventListener('input', (e) => {
                this.filterAPKs();
            });
            
            document.getElementById('category-filter').addEventListener('change', () => {
                this.filterAPKs();
            });
            
            document.getElementById('status-filter').addEventListener('change', () => {
                this.filterAPKs();
            });
        }
        
        async loadData() {
            if (this.supabase) {
                try {
                    // Load APKs
                    const { data: apks } = await this.supabase
                        .from('apks')
                        .select('*')
                        .order('created_at', { ascending: false });
                    
                    this.apks = apks || [];
                    
                    // Load users
                    const { data: users } = await this.supabase
                        .from('users')
                        .select('*')
                        .order('created_at', { ascending: false });
                    
                    this.users = users || [];
                    
                } catch (error) {
                    console.error('Error loading data:', error);
                    this.loadSampleData();
                }
            } else {
                this.loadSampleData();
            }
        }
        
        loadSampleData() {
            // Sample data for demo
            this.apks = [
                {
                    id: '1',
                    name: 'WhatsApp Plus',
                    version: '17.60.2',
                    category: 'Social',
                    download_count: 2847362,
                    rating: 4.8,
                    verified: true,
                    featured: true,
                    trending: true,
                    icon_url: 'https://images.sftcdn.net/images/t_app-icon-m/p/f4fbbd96-9b15-11e6-91f5-00163ed833e7/1919082909/whatsapp-messenger-icon.png'
                },
                {
                    id: '2',
                    name: 'Spotify Premium',
                    version: '8.7.88.475',
                    category: 'Music',
                    download_count: 3421876,
                    rating: 4.9,
                    verified: true,
                    featured: true,
                    trending: true,
                    icon_url: 'https://images.sftcdn.net/images/t_app-icon-m/p/b49eeea8-9b1a-11e6-96f3-00163ed833e7/1919082943/spotify-music-icon.png'
                }
            ];
            
            this.users = [
                {
                    id: '1',
                    username: 'admin',
                    email: 'admin@modapk.com',
                    role: 'super_admin',
                    created_at: new Date().toISOString()
                }
            ];
        }
        
        renderDashboard() {
            // Update stats
            document.getElementById('total-apks').textContent = this.apks.length;
            document.getElementById('total-downloads').textContent = this.apks.reduce((sum, apk) => sum + (apk.download_count || 0), 0).toLocaleString();
            document.getElementById('total-users').textContent = this.users.length;
            
            // Render activity
            this.renderActivity();
            
            // Initialize charts
            this.initCharts();
        }
        
        renderActivity() {
            const activityList = document.getElementById('activity-list');
            const activities = [
                { action: 'New APK added', item: 'WhatsApp Plus v17.60.2', time: '2 hours ago' },
                { action: 'User registered', item: 'john_doe', time: '3 hours ago' },
                { action: 'APK updated', item: 'Spotify Premium v8.7.88', time: '5 hours ago' }
            ];
            
            activityList.innerHTML = activities.map(activity => `
                <div class="activity-item">
                    <div class="activity-content">
                        <strong>${activity.action}</strong>: ${activity.item}
                    </div>
                    <div class="activity-time">${activity.time}</div>
                </div>
            `).join('');
        }
        
        initCharts() {
            // Downloads chart
            const ctx1 = document.getElementById('downloadsChart');
            if (ctx1) {
                new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                        datasets: [{
                            label: 'Downloads',
                            data: [1200, 1900, 3000, 5000, 2000, 3000, 4500],
                            borderColor: '#1FB8CD',
                            backgroundColor: 'rgba(31, 184, 205, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            }
            
            // Categories chart
            const ctx2 = document.getElementById('categoriesChart');
            if (ctx2) {
                new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['Social', 'Music', 'Entertainment', 'Games', 'Tools'],
                        datasets: [{
                            data: [30, 25, 20, 15, 10],
                            backgroundColor: ['#4267B2', '#1DB954', '#FF0000', '#FF6B6B', '#FF9500']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            }
        }
        
        renderAPKsTable() {
            const tableBody = document.getElementById('apks-table-body');
            if (!tableBody) return;
            
            tableBody.innerHTML = this.apks.map(apk => `
                <tr>
                    <td><input type="checkbox" value="${apk.id}"></td>
                    <td><img src="${apk.icon_url || '/default-icon.png'}" alt="${apk.name}" class="apk-icon-small"></td>
                    <td><strong>${apk.name}</strong></td>
                    <td>${apk.version}</td>
                    <td><span class="category-badge">${apk.category}</span></td>
                    <td>${(apk.download_count || 0).toLocaleString()}</td>
                    <td>
                        <div class="rating-stars">
                            ${'★'.repeat(Math.floor(apk.rating || 0))}
                            <span>${(apk.rating || 0).toFixed(1)}</span>
                        </div>
                    </td>
                    <td>
                        <div class="status-badges">
                            ${apk.verified ? '<span class="badge verified">Verified</span>' : ''}
                            ${apk.featured ? '<span class="badge featured">Featured</span>' : ''}
                            ${apk.trending ? '<span class="badge trending">Trending</span>' : ''}
                        </div>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button onclick="editAPK('${apk.id}')" class="btn-edit" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteAPK('${apk.id}')" class="btn-delete" title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }
        
        filterAPKs() {
            const search = document.getElementById('apk-search').value.toLowerCase();
            const category = document.getElementById('category-filter').value;
            const status = document.getElementById('status-filter').value;
            
            // Filter logic here
            this.renderAPKsTable();
        }
        
        async handleAddAPK(formData) {
            const apkData = {
                name: formData.get('name'),
                version: formData.get('version'),
                package_name: formData.get('package_name'),
                category: formData.get('category'),
                description: formData.get('description'),
                download_url: formData.get('download_url'),
                file_size: formData.get('file_size'),
                icon_url: formData.get('icon_url'),
                android_version: formData.get('android_version'),
                screenshot_urls: formData.get('screenshot_urls').split(',').map(url => url.trim()).filter(url => url),
                features: formData.get('features').split(',').map(f => f.trim()).filter(f => f),
                tags: formData.get('tags').split(',').map(t => t.trim()).filter(t => t),
                verified: formData.has('verified'),
                featured: formData.has('featured'),
                trending: formData.has('trending'),
                download_count: 0,
                rating: 0,
                review_count: 0
            };
            
            if (this.supabase) {
                try {
                    const { data, error } = await this.supabase
                        .from('apks')
                        .insert([apkData])
                        .select();
                    
                    if (error) throw error;
                    
                    this.apks.unshift(data[0]);
                    this.showNotification('APK added successfully!', 'success');
                } catch (error) {
                    console.error('Error adding APK:', error);
                    this.showNotification('Error adding APK: ' + error.message, 'error');
                }
            } else {
                // Local storage fallback
                apkData.id = Date.now().toString();
                this.apks.unshift(apkData);
                this.showNotification('APK added successfully!', 'success');
            }
            
            this.renderAPKsTable();
            this.closeModal('add-apk-modal');
            document.getElementById('add-apk-form').reset();
        }
        
        handleFileUpload(file) {
            if (!file.name.match(/\.(apk|xapk|apkm)$/)) {
                this.showNotification('Please select a valid APK file', 'error');
                return;
            }
            
            // Simulate file upload with progress
            const progressBar = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');
            const uploadProgress = document.getElementById('upload-progress');
            
            document.querySelector('#upload-area .upload-content').style.display = 'none';
            uploadProgress.style.display = 'block';
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    setTimeout(() => {
                        this.closeModal('file-upload-modal');
                        this.showNotification('File uploaded successfully!', 'success');
                        // Reset upload area
                        document.querySelector('#upload-area .upload-content').style.display = 'block';
                        uploadProgress.style.display = 'none';
                        progressBar.style.width = '0%';
                    }, 500);
                }
                
                progressBar.style.width = progress + '%';
                progressText.textContent = `Uploading... ${Math.round(progress)}%`;
            }, 200);
        }
        
        showNotification(message, type = 'info') {
            // Simple notification system
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 20px;
                border-radius: 8px;
                color: white;
                font-weight: 500;
                z-index: 10000;
                animation: slideIn 0.3s ease;
                background: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3'};
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }
        
        closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
    }
    
    // Global functions
    function showAdminView(viewName) {
        // Hide all views
        document.querySelectorAll('.admin-view').forEach(view => {
            view.classList.remove('active');
        });
        
        // Show selected view
        document.getElementById(`admin-${viewName}`).classList.add('active');
        
        // Update nav active state
        document.querySelectorAll('.admin-nav-item').forEach(item => {
            item.classList.remove('active');
        });
        event.target.closest('.admin-nav-item').classList.add('active');
        
        // Load specific view data
        if (viewName === 'apks') {
            adminPlatform.renderAPKsTable();
        }
    }
    
    function showAddAPKModal() {
        document.getElementById('add-apk-modal').style.display = 'flex';
    }
    
    function closeModal(modalId) {
        document.getElementById(modalId).style.display = 'none';
    }
    
    function editAPK(id) {
        console.log('Edit APK:', id);
        // Implement edit functionality
    }
    
    function deleteAPK(id) {
        if (confirm('Are you sure you want to delete this APK?')) {
            console.log('Delete APK:', id);
            // Implement delete functionality
        }
    }
    
    function bulkVerify() {
        const checked = document.querySelectorAll('#apks-table-body input[type="checkbox"]:checked');
        console.log('Bulk verify:', checked.length, 'items');
    }
    
    function bulkDelete() {
        const checked = document.querySelectorAll('#apks-table-body input[type="checkbox"]:checked');
        if (checked.length > 0 && confirm(`Delete ${checked.length} APKs?`)) {
            console.log('Bulk delete:', checked.length, 'items');
        }
    }
    
    function adminLogout() {
        if (confirm('Are you sure you want to logout?')) {
            localStorage.removeItem('isAdmin');
            window.location.href = 'index.html';
        }
    }
    
    function saveSettings() {
        adminPlatform.showNotification('Settings saved successfully!', 'success');
    }
    
    function resetSettings() {
        if (confirm('Reset all settings to default?')) {
            adminPlatform.showNotification('Settings reset to default', 'info');
        }
    }
    
    function updateAnalytics() {
        adminPlatform.showNotification('Analytics updated', 'info');
    }
    
    // Initialize admin platform
    let adminPlatform;
    document.addEventListener('DOMContentLoaded', () => {
        adminPlatform = new AdminPlatform();
    });
    </script>

    <style>
    /* Admin-specific styles */
    .admin-navbar {
        background: linear-gradient(135deg, #1FB8CD 0%, #159ba8 100%);
        padding: 0;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
    }
    
    .admin-nav-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 24px;
        height: 64px;
    }
    
    .admin-nav-brand {
        display: flex;
        align-items: center;
        color: white;
        font-weight: 700;
        font-size: 20px;
        gap: 8px;
    }
    
    .admin-nav-menu {
        display: flex;
        gap: 8px;
    }
    
    .admin-nav-item {
        background: none;
        border: none;
        color: white;
        padding: 8px 16px;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 14px;
    }
    
    .admin-nav-item:hover {
        background: rgba(255,255,255,0.1);
    }
    
    .admin-nav-item.active {
        background: rgba(255,255,255,0.2);
    }
    
    .admin-user-info {
        display: flex;
        align-items: center;
        gap: 12px;
        color: white;
    }
    
    .btn-logout {
        background: none;
        border: none;
        color: white;
        padding: 8px;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .btn-logout:hover {
        background: rgba(255,255,255,0.1);
    }
    
    .admin-container {
        margin-top: 64px;
        padding: 24px;
        min-height: calc(100vh - 64px);
        background: #f8f9fa;
    }
    
    .admin-view {
        display: none;
    }
    
    .admin-view.active {
        display: block;
    }
    
    .admin-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
        padding-bottom: 16px;
        border-bottom: 2px solid #e9ecef;
    }
    
    .admin-header h1 {
        font-size: 28px;
        color: #2c3e50;
        margin: 0;
    }
    
    .admin-header p {
        color: #6c757d;
        margin: 4px 0 0 0;
    }
    
    .admin-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 32px;
    }
    
    .stat-card {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        display: flex;
        align-items: center;
        gap: 16px;
        transition: all 0.2s;
    }
    
    .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 16px rgba(0,0,0,0.15);
    }
    
    .stat-icon {
        width: 56px;
        height: 56px;
        border-radius: 12px;
        background: linear-gradient(135deg, #1FB8CD, #159ba8);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
    }
    
    .stat-content {
        flex: 1;
    }
    
    .stat-number {
        font-size: 32px;
        font-weight: 700;
        color: #2c3e50;
        line-height: 1;
        margin-bottom: 4px;
    }
    
    .stat-label {
        color: #6c757d;
        font-size: 14px;
        font-weight: 500;
    }
    
    .admin-charts {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 20px;
        margin-bottom: 32px;
    }
    
    .chart-card {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .chart-card h3 {
        margin: 0 0 20px 0;
        color: #2c3e50;
        font-size: 18px;
    }
    
    .chart-card canvas {
        max-height: 300px;
    }
    
    .recent-activity {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .recent-activity h3 {
        margin: 0 0 20px 0;
        color: #2c3e50;
        font-size: 18px;
    }
    
    .activity-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .activity-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 8px;
        border-left: 4px solid #1FB8CD;
    }
    
    .activity-time {
        color: #6c757d;
        font-size: 12px;
    }
    
    .admin-filters {
        background: white;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 16px;
    }
    
    .filter-group {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
    }
    
    .filter-input, .filter-select {
        padding: 8px 12px;
        border: 2px solid #e9ecef;
        border-radius: 6px;
        font-size: 14px;
        transition: all 0.2s;
        min-width: 200px;
    }
    
    .filter-input:focus, .filter-select:focus {
        outline: none;
        border-color: #1FB8CD;
    }
    
    .bulk-actions {
        display: flex;
        gap: 8px;
    }
    
    .apks-table-container, .users-table-container {
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        overflow: hidden;
    }
    
    .apks-table, .users-table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .apks-table th, .users-table th {
        background: #f8f9fa;
        padding: 16px 12px;
        text-align: left;
        font-weight: 600;
        color: #2c3e50;
        border-bottom: 2px solid #e9ecef;
    }
    
    .apks-table td, .users-table td {
        padding: 16px 12px;
        border-bottom: 1px solid #e9ecef;
        vertical-align: middle;
    }
    
    .apk-icon-small {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        object-fit: cover;
    }
    
    .category-badge {
        background: #e3f2fd;
        color: #1976d2;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 500;
    }
    
    .rating-stars {
        color: #ffc107;
        font-size: 14px;
    }
    
    .status-badges {
        display: flex;
        gap: 4px;
        flex-wrap: wrap;
    }
    
    .badge {
        padding: 2px 6px;
        border-radius: 10px;
        font-size: 10px;
        font-weight: 500;
        text-transform: uppercase;
    }
    
    .badge.verified { background: #d4edda; color: #155724; }
    .badge.featured { background: #fff3cd; color: #856404; }
    .badge.trending { background: #f8d7da; color: #721c24; }
    
    .action-buttons {
        display: flex;
        gap: 4px;
    }
    
    .btn-edit, .btn-delete {
        width: 32px;
        height: 32px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
        font-size: 12px;
    }
    
    .btn-edit {
        background: #e3f2fd;
        color: #1976d2;
    }
    
    .btn-edit:hover {
        background: #1976d2;
        color: white;
    }
    
    .btn-delete {
        background: #ffebee;
        color: #d32f2f;
    }
    
    .btn-delete:hover {
        background: #d32f2f;
        color: white;
    }
    
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.5);
        z-index: 10000;
        align-items: center;
        justify-content: center;
        padding: 20px;
    }
    
    .modal-content {
        background: white;
        border-radius: 12px;
        width: 100%;
        max-width: 600px;
        max-height: 90vh;
        overflow-y: auto;
    }
    
    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        border-bottom: 2px solid #e9ecef;
    }
    
    .modal-header h2 {
        margin: 0;
        color: #2c3e50;
    }
    
    .modal-close {
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: #6c757d;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: all 0.2s;
    }
    
    .modal-close:hover {
        background: #f8f9fa;
        color: #2c3e50;
    }
    
    .modal-form {
        padding: 20px;
    }
    
    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
        margin-bottom: 16px;
    }
    
    .form-group {
        display: flex;
        flex-direction: column;
        gap: 6px;
    }
    
    .form-group label {
        font-weight: 500;
        color: #2c3e50;
        font-size: 14px;
    }
    
    .form-input, .form-select, .form-textarea {
        padding: 10px 12px;
        border: 2px solid #e9ecef;
        border-radius: 6px;
        font-size: 14px;
        transition: all 0.2s;
    }
    
    .form-input:focus, .form-select:focus, .form-textarea:focus {
        outline: none;
        border-color: #1FB8CD;
    }
    
    .form-checkboxes {
        display: flex;
        gap: 16px;
        margin: 16px 0;
    }
    
    .checkbox-label {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 14px;
        cursor: pointer;
    }
    
    .form-actions {
        display: flex;
        justify-content: flex-end;
        gap: 12px;
        margin-top: 24px;
        padding-top: 20px;
        border-top: 2px solid #e9ecef;
    }
    
    .upload-area {
        padding: 40px 20px;
        border: 2px dashed #1FB8CD;
        border-radius: 12px;
        text-align: center;
        cursor: pointer;
        transition: all 0.2s;
        margin: 20px;
    }
    
    .upload-area:hover {
        background: #f0fdff;
        border-color: #159ba8;
    }
    
    .upload-icon {
        font-size: 48px;
        color: #1FB8CD;
        margin-bottom: 16px;
    }
    
    .upload-area h3 {
        margin: 0 0 8px 0;
        color: #2c3e50;
    }
    
    .upload-area p {
        margin: 0;
        color: #6c757d;
    }
    
    .upload-progress {
        padding: 20px;
    }
    
    .progress-bar {
        width: 100%;
        height: 8px;
        background: #e9ecef;
        border-radius: 4px;
        overflow: hidden;
        margin-bottom: 12px;
    }
    
    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #1FB8CD, #159ba8);
        transition: width 0.3s;
        width: 0%;
    }
    
    .progress-text {
        text-align: center;
        color: #2c3e50;
        font-weight: 500;
    }
    
    .analytics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
    }
    
    .analytics-card {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .analytics-card h3 {
        margin: 0 0 20px 0;
        color: #2c3e50;
        font-size: 18px;
    }
    
    .settings-sections {
        display: flex;
        flex-direction: column;
        gap: 32px;
    }
    
    .settings-section {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .settings-section h3 {
        margin: 0 0 20px 0;
        color: #2c3e50;
        font-size: 18px;
        padding-bottom: 12px;
        border-bottom: 2px solid #e9ecef;
    }
    
    .setting-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #f8f9fa;
    }
    
    .setting-item:last-child {
        border-bottom: none;
    }
    
    .setting-item label {
        font-weight: 500;
        color: #2c3e50;
    }
    
    .setting-input, .setting-textarea {
        padding: 6px 10px;
        border: 2px solid #e9ecef;
        border-radius: 4px;
        font-size: 14px;
        min-width: 200px;
    }
    
    .setting-textarea {
        resize: vertical;
        min-height: 60px;
    }
    
    .setting-checkbox {
        width: 20px;
        height: 20px;
    }
    
    .settings-actions {
        display: flex;
        justify-content: center;
        gap: 12px;
        margin-top: 24px;
    }
    
    .date-range {
        display: flex;
        gap: 12px;
        align-items: center;
    }
    
    .date-input {
        padding: 8px 12px;
        border: 2px solid #e9ecef;
        border-radius: 6px;
        font-size: 14px;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
        .admin-nav-container {
            padding: 0 16px;
        }
        
        .admin-nav-menu {
            display: none;
        }
        
        .admin-container {
            padding: 16px;
        }
        
        .admin-stats {
            grid-template-columns: 1fr;
        }
        
        .admin-charts {
            grid-template-columns: 1fr;
        }
        
        .form-row {
            grid-template-columns: 1fr;
        }
        
        .filter-group {
            flex-direction: column;
        }
        
        .filter-input, .filter-select {
            min-width: auto;
            width: 100%;
        }
    }
    </style>
</body>
</html>